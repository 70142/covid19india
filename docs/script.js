var alldata=[],statewise={},maxConfirmed=0,lastUpdated="",newjson=[];function is_touch_device(){try{return document.createEvent("TouchEvent"),!0}catch(t){return!1}}function initMapStuff(){var t=L.map("map").setView([22.5,82],3);t.setMaxBounds(t.getBounds()),t.setView([22.5,82],4),is_touch_device()&&(t.dragging.disable(),t.tap.disable()),L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1Ijoic3VkZXZzY2hpeiIsImEiOiJjazdvbGg1ZWMwOW52M21wOWEzZzFmcWhnIn0.hN6tcoQ3uo-ha-hmki5Qew",{maxZoom:6,minZoom:4,id:"mapbox/light-v9",tileSize:512,zoomOffset:-1}).addTo(t);var e,a=L.control();function l(t){e.resetStyle(),a.update();var l=t.target;l.setStyle({weight:1,color:"#000000",dashArray:""}),L.Browser.ie||L.Browser.opera||L.Browser.edge||l.bringToFront(),a.update(l.feature.properties)}function o(t){e.resetStyle(t.target),a.update()}a.onAdd=function(t){return this._div=L.DomUtil.create("div","info"),this.update(),this._div},a.update=function(t){t&&(this._div.innerHTML="<h4>"+t.NAME_1+"</h4><pre>Confirmed: "+statewise[t.NAME_1][1]+"<br>Recovered: "+statewise[t.NAME_1][2]+"<br>Deaths   : "+statewise[t.NAME_1][3]+"<br>Active   : "+statewise[t.NAME_1][4]+"</pre>")},a.addTo(t),e=L.geoJson(statesData,{style:function(t){var e=0;return statewise[t.properties.NAME_1]&&(e=statewise[t.properties.NAME_1][1]),{weight:1,opacity:1,color:"#bfbfbf",fillOpacity:e/maxConfirmed*.8,fillColor:"red"}},onEachFeature:function(t,e){e.on({mouseover:l,mouseout:o,click:l})}}).addTo(t)}$.getJSON("https://spreadsheets.google.com/feeds/cells/1nzXUdaIWC84QipdVGUKTiCSc5xntBbpMpzLm6Si33zk/ovd0hzm/public/values?alt=json",(function(t){entries=t.feed.entry,entries.forEach((function(t){null==newjson[t.gs$cell.row-1]&&(newjson[t.gs$cell.row-1]=[],alldata[t.gs$cell.row-1]=[]),parseInt(t.gs$cell.col)-1<2&&(isNaN(t.gs$cell.$t)?newjson[t.gs$cell.row-1][t.gs$cell.col-1]=t.gs$cell.$t:newjson[t.gs$cell.row-1][t.gs$cell.col-1]=parseInt(t.gs$cell.$t)),alldata[t.gs$cell.row-1][t.gs$cell.col-1]=t.gs$cell.$t})),newjson.splice(1,1),maxConfirmed=alldata[2][1],lastUpdated=alldata[1][5];for(var e=0;e<alldata.length;e++)alldata[e].splice(5,1);alldata.forEach((function(t){statewise[t[0]]=t}));var a=0,l="<thead>";for(e=0;e<alldata.length;e++)if(0==e)l+="<tr>",alldata[e].forEach((function(t){l+="<th>"+t+"</th>"})),l+="</tr></thead><tbody>";else{if(1==e)continue;tempdata=Array.from(alldata[e]),tempdata.splice(0,1),allzero=!0,tempdata.forEach((function(t){0!=t&&(allzero=!1)})),allzero||(a++,l+="<tr>",alldata[e].forEach((function(t){l+="<td>"+t+"</td>"})),l+="</tr>")}l+='<tr class="totals">',alldata[1].forEach((function(t){l+="<td>"+t+"</td>"})),l+="</tr>",l+="</tbody>",alldata.forEach((function(t){l+=t[0]})),$("table#prefectures-table").html(l),$("div#states-value").html(a),$("div#confvalue").html(alldata[1][1]),$("div#deathsvalue").html(alldata[1][3]),$("div#recoveredvalue").html(alldata[1][2]),$("strong#last-updated").html(lastUpdated),initMapStuff()}));
